(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{"7i70":function(t,e,r){"use strict";(function(t,n){r.d(e,"a",function(){return j});var o=r("gDde"),a=r("co3k"),i=r("z4Qk"),c=r("qoM+"),u=r("jdJj"),l=r("PyG4"),s=r("Aimb"),f=r.n(s);function d(){return(d=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function h(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return t.length>n?{done:!1,value:t[n++]}:{done:!0}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=t[Symbol.iterator]()).next.bind(r)}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);e>r;r++)n[r]=t[r];return n}function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function v(t){for(var e=1;arguments.length>e;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach(function(e){y(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var g=t.t("Change Department"),w=t.t("Choose a department"),O=n(u.b.Footer,null),j=function(e){var r,o;function s(t){var r;y(b(r=e.call(this,t)||this),"state",{department:null}),y(b(r),"validations",{department:[c.e.nonEmpty]}),y(b(r),"getValidableFields",function(){return Object.keys(r.validations).map(function(t){return r.state[t]?v({fieldName:t},r.state[t]):null}).filter(Boolean)}),y(b(r),"validate",function(t,e){return r.validations[t].reduce(function(t,r){return t||r(e)},void 0)}),y(b(r),"validateAll",function(){for(var t,e=h(r.getValidableFields());!(t=e()).done;){var n,o=t.value,a=o.fieldName,i=o.value,c=r.validate(a,i);r.setState(((n={})[a]=v(v({},r.state[a]),{},{value:i,error:c,showError:!1}),n))}}),y(b(r),"isValid",function(){return r.getValidableFields().every(function(t){return!(void 0===t?{}:t).error})}),y(b(r),"handleFieldChange",function(t){return function(e){var n,o=e.target.value,a=r.validate(t,o);r.setState(((n={})[t]=v(v({},r.state[t]),{},{value:o,error:a,showError:!1}),n))}}),y(b(r),"handleDepartmentChange",r.handleFieldChange("department")),y(b(r),"handleSubmit",function(t){if(t.preventDefault(),r.props.onSubmit){var e=Object.entries(r.state).filter(function(t){return null!==t[1]}).map(function(t){var e;return(e={})[t[0]]=t[1].value,e}).reduce(function(t,e){return v(v({},t),e)},{});r.props.onSubmit(e)}}),y(b(r),"handleCancelClick",function(){var t=r.props.onCancel;t&&t()});var n=t.departments;return n&&n.length>0&&(r.state.department={value:""}),r.validateAll(),r}o=e,(r=s).prototype=Object.create(o.prototype),r.prototype.constructor=r,r.__proto__=o;var p=s.prototype;return p.componentWillReceiveProps=function(){this.state.department||this.setState({department:v(v({},this.state.department),{},{value:""})})},p.render=function(e,r){var o=r.department,s=e.title,h=e.color,p=e.message,m=e.loading,v=e.departments,b=function(t,e){if(null==t)return{};var r,n,o={},a=Object.keys(t);for(n=0;a.length>n;n++)0>e.indexOf(r=a[n])&&(o[r]=t[r]);return o}(e,["title","color","message","loading","departments"]),y=this.isValid();return n(u.b,d({color:h,title:s||g,className:Object(l.d)(f.a,"switch-department")},b),n(u.b.Content,null,n("p",{className:Object(l.d)(f.a,"switch-department__message")},p||w),n(c.a,{onSubmit:this.handleSubmit},n(c.b,{label:t.t("Departments"),error:o&&o.showError&&o.error},n(c.c,{name:"department",value:o&&o.value,options:v.map(function(t){return{value:t._id,label:t.name}}),placeholder:t.t("Choose a department..."),disabled:m,error:o&&o.showError,onInput:this.handleDepartmentChange})),n(i.a,null,n(a.a,{submit:!0,loading:m,disabled:!y||m,stack:!0},t.t("Start chat")),n(a.a,{disabled:m,stack:!0,secondary:!0,nude:!0,onClick:this.handleCancelClick},t.t("Cancel"))))),O)},s}(o.Component)}).call(this,r("fsQa").default,r("gDde").h)},POey:function(t,e,r){"use strict";r.r(e);var n=r("7i70");r.d(e,"SwitchDepartment",function(){return n.a});var o=r("xFLU");r.d(e,"SwitchDepartmentContainer",function(){return o.b}),r.d(e,"SwitchDepartmentConnector",function(){return o.a}),r.d(e,"default",function(){return o.c})},xFLU:function(t,e,r){"use strict";(function(t,n){r.d(e,"b",function(){return m}),r.d(e,"a",function(){return v});var o=r("gDde"),a=r("qPgm"),i=r("UEyv"),c=r("kQFM"),u=r("7i70"),l=r("81xT"),s=r("PyG4"),f=r("SGp1");function d(){return(d=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var m=function(e){var r,o;function c(){for(var r,o=arguments.length,c=new Array(o),m=0;o>m;m++)c[m]=arguments[m];return p(h(r=e.call.apply(e,[this].concat(c))||this),"confirmChangeDepartment",function(){return new Promise(function(e,r){var n;return Promise.resolve(l.a.confirm({text:t.t("Are you sure you want to switch the department?")})).then(function(t){try{return e("boolean"==typeof(n=t).success&&n.success)}catch(t){return r(t)}},r)})}),p(h(r),"handleSubmit",function(e){return new Promise(function(n,o){var c,u,d,h,p,m;return u=(c=r.props).alerts,d=c.dispatch,h=c.room,p=c.token,m=e.department,Promise.resolve(r.confirmChangeDepartment()).then(function(e){try{if(!e)return n();if(!h)return Promise.resolve(a.a.grantVisitor({visitor:{department:m,token:p}})).then(function(e){try{return Promise.resolve(d({user:e,alerts:(u.push({id:Object(s.e)(),children:t.t("Department switched"),success:!0}),u)})).then(function(){try{return n(f.a.go(-1))}catch(t){return o(t)}},o)}catch(t){return o(t)}},o);var r=function(t){return function(e){try{return Promise.resolve(d({loading:!1})).then(function(){try{return t&&t.call(this,e)}catch(t){return o(t)}}.bind(this),o)}catch(t){return o(t)}}.bind(this)}.bind(this);return Promise.resolve(d({loading:!0})).then(function(){try{var e=function(){try{return n()}catch(t){return o(t)}},c=function(){try{return Promise.resolve(d({alerts:(u.push({id:Object(s.e)(),children:t.t("No available agents to transfer"),warning:!0}),u)})).then(function(){try{return r(e)()}catch(t){return o(t)}},o)}catch(t){return r(o)(t)}};try{return Promise.resolve(a.a.transferChat({rid:h._id,department:m})).then(function(n){try{if(!n.success)throw t.t("No available agents to transfer");return Promise.resolve(d({department:m})).then(function(){try{return Promise.resolve(Object(i.a)()).then(function(){try{return Promise.resolve(l.a.alert({text:t.t("Department switched")})).then(function(){try{return f.a.go(-1),r(e)()}catch(t){return c()}},c)}catch(t){return c()}},c)}catch(t){return c()}},c)}catch(t){return c()}},c)}catch(t){c()}}catch(t){return o(t)}},o)}catch(t){return o(t)}}.bind(this),o)})}),p(h(r),"handleCancel",function(){f.a.go(-1)}),p(h(r),"render",function(t){return n(u.a,d({},t,{onSubmit:r.handleSubmit,onCancel:r.handleCancel}))}),r}return o=e,(r=c).prototype=Object.create(o.prototype),r.prototype.constructor=r,r.__proto__=o,c}(o.Component),v=function(t){var e=t.ref,r=function(t,e){if(null==t)return{};var r,n,o={},a=Object.keys(t);for(n=0;a.length>n;n++)0>e.indexOf(r=a[n])&&(o[r]=t[r]);return o}(t,["ref"]);return n(c.a,null,function(t){var o=t.config,a=(o=void 0===o?{}:o).departments,i=o.theme;i=void 0===i?{}:i;var c=t.iframe,u=(c=void 0===c?{}:c).theme,l=t.room,s=t.loading,f=t.department,h=t.dispatch,p=t.alerts,v=t.token;return n(m,d({ref:e},r,{theme:{color:(u=void 0===u?{}:u).color||i.color,fontColor:u.fontColor,iconColor:u.iconColor},loading:void 0!==s&&s,departments:(void 0===a?{}:a).filter(function(t){return t.showOnRegistration&&t._id!==f}),dispatch:h,room:l,alerts:p,token:v}))})};e.c=v}).call(this,r("fsQa").default,r("gDde").h)}}]);