(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{"/9tl":function(e,t,r){"use strict";(function(e,n){r.d(t,"a",function(){return D});var a=r("gDde"),i=r("co3k"),o=r("z4Qk"),l=r("qoM+"),u=r("jdJj"),s=r("PyG4"),c=r("qYlV"),d=r.n(c);function p(){return(p=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function m(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;i.length>n;n++)0>t.indexOf(r=i[n])&&(a[r]=e[r]);return a}function f(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return e.length>n?{done:!1,value:e[n++]}:{done:!0}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);t>r;r++)n[r]=e[r];return n}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function b(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var O=e.t("Need help?"),j=e.t("Please, tell us some information to start the chat"),w=function(e){return void 0===e&&(e=[]),1===e.length&&e[0]._id||""},F=n(u.b.Footer,null),D=function(t){var r,a;function c(e){var r;return y(g(r=t.call(this,e)||this),"state",{name:null,email:null,department:null}),y(g(r),"validations",{name:[l.e.nonEmpty],email:[l.e.nonEmpty,l.e.email],department:[]}),y(g(r),"getDefaultState",function(){var e=r.props,t=e.hasEmailField,n=e.hasDepartmentField,a=e.departments,i=e.customFields,o=void 0===i?[]:i,l=b(b(b({},e.hasNameField&&{name:{value:""}}),t&&{email:{value:""}}),n&&{department:{value:w(a)}});return o.forEach(function(e){var t=e._id,r=e.defaultValue,n=e.options,a=e.regexp,i="";(r&&!n||Array.isArray(n)&&n.includes(r))&&(i=r),l[t]=b({value:i},a&&{regexp:a})}),l}),y(g(r),"getCustomValidations",function(){var e=r.props.customFields;return(void 0===e?[]:e).map(function(e){var t,r=e._id,n=e.regexp,a=[];return e.required&&a.push(l.e.nonEmpty),n&&a.push(l.e.custom),(t={})[r]=a,t}).reduce(function(e,t){return b(b({},e),t)},{})}),y(g(r),"getValidableFields",function(){return Object.keys(r.validations).map(function(e){return r.state[e]?b({fieldName:e},r.state[e]):null}).filter(Boolean)}),y(g(r),"validate",function(e){var t=e.value,n=e.regexp;return r.validations[e.name].reduce(function(e,r){return e||r({value:t,pattern:n})},void 0)}),y(g(r),"validateAll",function(){for(var e,t=f(r.getValidableFields());!(e=t()).done;){var n,a=e.value,i=a.fieldName,o=a.value,l=r.validate({name:i,value:o,regexp:a.regexp});r.setState(((n={})[i]=b(b({},r.state[i]),{},{value:o,error:l,showError:!1}),n))}}),y(g(r),"isValid",function(){return r.getValidableFields().every(function(e){return!(void 0===e?{}:e).error})}),y(g(r),"handleFieldChange",function(e){var t,n=e.target,a=n.name,i=n.value,o=r.validate({name:a,value:i,regexp:r.state[a].regexp});r.setState(((t={})[a]=b(b({},r.state[a]),{},{value:i,error:o,showError:!0}),t))}),y(g(r),"handleSubmit",function(e){if(e.preventDefault(),r.props.onSubmit){var t=Object.entries(r.state).filter(function(e){return null!==e[1]}).map(function(e){var t;return(t={})[e[0]]=e[1].value,t}).reduce(function(e,t){return b(b({},e),t)},{});r.props.onSubmit(t)}}),r.setState(r.getDefaultState()),r.validations=b(b({},r.validations),r.getCustomValidations()),r.validateAll(),r}a=t,(r=c).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a;var h=c.prototype;return h.componentWillReceiveProps=function(e){var t=e.hasNameField,r=e.hasEmailField,n=e.hasDepartmentField,a=e.departmentDefault,i=e.departments,o=e.emailDefault,l=e.nameDefault||"";!t||this.state.name&&this.state.name===l?t||this.setState({name:null}):this.setState({name:b(b({},this.state.name),{},{value:l})});var u=o||"";!r||this.state.email&&this.state.name===u?r||this.setState({email:null}):this.setState({email:b(b({},this.state.email),{},{value:u})});var s=a||w(i),c=n&&i&&i.length>1;!c||this.state.department&&this.state.department===s?c||this.setState({department:null}):this.setState({department:b(b({},this.state.department),{},{value:s})}),this.validateAll()},h.render=function(t,r){var a=r.name,c=r.email,f=r.department,h=m(r,["name","email","department"]),v=t.title,b=t.color,g=t.message,y=t.loading,w=t.departments,D=t.customFields,S=m(t,["title","color","message","loading","departments","customFields"]),P=this.isValid();return n(u.b,p({color:b,title:v||O,className:Object(s.d)(d.a,"register")},S),n(u.b.Content,null,n("p",{className:Object(s.d)(d.a,"register__message")},g||j),n(l.a,{onSubmit:this.handleSubmit},a?n(l.b,{required:!0,label:e.t("Name"),error:a.showError&&a.error},n(l.d,{name:"name",value:a.value,placeholder:e.t("Insert your %{field} here...",{field:e.t("Name")}),disabled:y,onInput:this.handleFieldChange})):null,c?n(l.b,{required:!0,label:e.t("Email"),error:c.showError&&c.error},n(l.d,{name:"email",value:c.value,placeholder:e.t("Insert your %{field} here...",{field:e.t("Email")}),disabled:y,onInput:this.handleFieldChange})):null,f?n(l.b,{label:e.t("I need help with..."),error:f.showError&&f.error},n(l.c,{name:"department",value:f.value,options:Object(s.m)(w,"name").map(function(e){return{value:e._id,label:e.name}}),placeholder:e.t("Choose an option..."),disabled:y,onInput:this.handleFieldChange})):null,D&&function(t,r,a){var i=r.loading,o=r.handleFieldChange,u=void 0===o?function(){}:o;return t.map(function(t){var r=t._id,o=t.required,s=t.label,c=t.options;switch(t.type){case"input":return n(l.b,{label:s,required:o,key:r,error:a[r].showError&&a[r].error},n(l.d,{name:r,placeholder:e.t("Insert your %{field} here...",{field:s}),value:a[r].value,disabled:i,onInput:u,custom:!0}));case"select":return n(l.b,{label:s,required:o,key:r,error:a[r].showError&&a[r].error},n(l.c,{name:r,value:a[r].value,placeholder:e.t("Choose an option..."),options:c&&c.map(function(e){return{value:e,label:e}}),disabled:i,onInput:u,custom:!0}))}return null})}(D,{loading:y,handleFieldChange:this.handleFieldChange},h),n(o.a,null,n(i.a,{submit:!0,loading:y,disabled:!P||y,stack:!0},e.t("Start chat"))))),F)},c}(a.Component)}).call(this,r("fsQa").default,r("gDde").h)},B2hK:function(e,t,r){"use strict";r.r(t);var n=r("/9tl");r.d(t,"Register",function(){return n.a});var a=r("gjNO");r.d(t,"RegisterContainer",function(){return a.b}),r.d(t,"RegisterConnector",function(){return a.a}),r.d(t,"default",function(){return a.c})},gjNO:function(e,t,r){"use strict";(function(e){r.d(t,"b",function(){return v}),r.d(t,"a",function(){return b});var n=r("gDde"),a=r("Y3FI"),i=r("qPgm"),o=r("vBLd"),l=r("SvlM"),u=r("kQFM"),s=r("/9tl");function c(){return(c=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){h(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function m(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;i.length>n;n++)0>t.indexOf(r=i[n])&&(a[r]=e[r]);return a}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=function(t){var r,n;function u(){for(var r,n=arguments.length,a=new Array(n),l=0;n>l;l++)a[l]=arguments[l];return h(f(r=t.call.apply(t,[this].concat(a))||this),"getDepartment",function(e){if(""!==e)return e;var t=r.props.departments,n=(void 0===t?{}:t).find(function(e){return e.showOnRegistration});return n?n._id:void 0}),h(f(r),"handleSubmit",function(e){return new Promise(function(t,n){var a,l,u,s,c,d,f,h,v=function(e){return function(t){try{return Promise.resolve(d({loading:!1})).then(function(){try{return e&&e.call(this,t)}catch(e){return n(e)}}.bind(this),n)}catch(e){return n(e)}}.bind(this)}.bind(this);return a=e.name,l=e.email,u=e.department,s=m(e,["name","email","department"]),d=(c=r.props).dispatch,f=c.token,h={name:a,email:l,department:r.getDepartment(u)},Promise.resolve(d({loading:!0,department:u})).then(function(){try{var e=function(){try{return t()}catch(e){return n(e)}},a=function(e){try{throw e}catch(e){return v(n)(e)}};try{return Promise.resolve(i.a.grantVisitor({visitor:p(p({},h),{},{token:f})})).then(function(t){try{return Promise.resolve(d({user:t})).then(function(){try{return Object(o.a)("callback",["pre-chat-form-submit",h]),r.registerCustomFields(s),v(e)()}catch(e){return a(e)}},a)}catch(e){return a(e)}},a)}catch(e){a(e)}}catch(e){return n(e)}},n)})}),h(f(r),"render",function(t){return e(s.a,c({},t,{onSubmit:r.handleSubmit,departmentDefault:r.getDepartmentDefault()}))}),r}n=t,(r=u).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n;var d=u.prototype;return d.registerCustomFields=function(e){void 0===e&&(e={}),Object.entries(e).forEach(function(e){var t=e[1];t&&""!==t&&l.a.setCustomField(e[0],t,!0)})},d.getDepartmentDefault=function(){var e=this.props,t=e.guestDepartment,r=e.departments;if(r&&r.some(function(e){return e._id===t}))return t},d.componentDidUpdate=function(e){var t=this.props.user;!e.user&&t&&t._id&&Object(a.b)("/")},u}(n.Component),b=function(t){var r=t.ref,n=m(t,["ref"]);return e(u.a,null,function(t){var a=t.config,i=(a=void 0===a?{}:a).departments,o=void 0===i?{}:i,l=a.messages;l=void 0===l?{}:l;var u=a.settings;u=void 0===u?{}:u;var s=a.theme;s=void 0===s?{}:s;var d=a.customFields,p=void 0===d?[]:d,m=t.iframe,f=(m=void 0===m?{}:m).guest,h=(f=void 0===f?{}:f).department,b=f.name,g=f.email,y=m.theme,O=(y=void 0===y?{}:y).title,j=t.loading,w=void 0!==j&&j,F=t.token,D=t.dispatch,S=t.user;return e(v,c({ref:r},n,{theme:{color:y.color||s.color,fontColor:y.fontColor,iconColor:y.iconColor,title:O},title:O||s.title,message:l.registrationFormMessage,hasNameField:u.nameFieldRegistrationForm,hasEmailField:u.emailFieldRegistrationForm,hasDepartmentField:o&&o.some(function(e){return e.showOnRegistration}),departments:o.filter(function(e){return e.showOnRegistration}),nameDefault:b,emailDefault:g,guestDepartment:h,loading:w,token:F,dispatch:D,user:S,customFields:p}))})};t.c=b}).call(this,r("gDde").h)}}]);